formulas:
  DangerBadge: |
    js:
    const d = target.danger_level ?? target.dangerLevel ?? 0;
    if (d >= 8) return 'ðŸ”´ ' + d;
    if (d >= 5) return 'ðŸŸ  ' + d;
    if (d >= 3) return 'ðŸŸ¡ ' + d;
    if (d > 0) return 'ðŸŸ¢ ' + d;
    return '';
  QuestCount: |
    js:
    const qs = target.active_quests || target.activeQuests || [];
    return Array.isArray(qs) ? qs.length : 0;
  RegionDisplay: |
    js:
    return target.region || '-';
views:
  - type: table
    name: All Locations
    filters: tags contains "Category/Place"
    sort:
      - property: file.name
        direction: ASC
    limit: 200
    columns:
      - file.name
      - type
      - region
      - faction
    columnSize:
      file.name: 200
      type: 120
      region: 150
      faction: 150
  - type: table
    name: Quest Hubs
    filters:
      and:
        - tags contains "Category/Place"
        - active_quests
    sort:
      - property: danger_level
        direction: DESC
    columns:
      - file.name
      - active_quests
      - danger_level
      - region
    columnSize:
      file.name: 240
      formula.QuestCount: 120
      formula.DangerBadge: 100
      region: 180
  - type: table
    name: All Locations
    filters: tags contains "Category/Place"
    sort:
      - property: file.name
        direction: ASC
    columns:
      - file.name
      - type
      - region
      - faction
      - danger_level
    columnSize:
      file.name: 240
      type: 140
      region: 160
      faction: 160
      formula.DangerBadge: 100
  - type: table
    name: Dangerous Areas
    filters:
      and:
        - tags contains "Category/Place"
        - danger_level
    sort:
      - property: danger_level
        direction: DESC
    columns:
      - file.name
      - region
      - danger_level
    columnSize:
      file.name: 240
      region: 160
      formula.DangerBadge: 100
  - type: table
    name: By Region
    filters: tags contains "Category/Place"
    sort:
      - property: region
        direction: ASC
      - property: file.name
        direction: ASC
    columns:
      - region
      - file.name
  - type: table
    name: All (Debug)
    sort:
      - property: file.name
        direction: ASC
    columns:
      - file.name
      - type
      - region
      - faction
      - tags
    columnSize:
      file.name: 200
      type: 120
      region: 150
      faction: 150
      tags: 200
